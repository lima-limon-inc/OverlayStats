Title: Сторонние модули NginX теперь выделены в отдельные пакеты
Author: Vadim A. Misbakh-Soloviov <overlay.news.nginx.ru@mva.name>
Posted: 2017-10-12
Revision: 1
News-Item-Format: 2.0
Display-If-Installed: <www-servers/nginx-1.13.6:mainline

Начиная с текущего релиза (1.13.6), все сторонние модули NginX'а
    отделены из его пакета (со статической линковкой) в отдельные
    пакеты с динамическими модулями.

Данный шаг позволит упростить как процедуру сопровождения модулей, так
    и процедуру добавления новых.
    А так же, сильно сократит время на апгрейды NginX'а.

К сожалению, данное решение далось не без последствий.
В связи с этим, при апгрейде необходимо помнить несколько вещей:

1) Теперь все используемые в конфигурации модули *ОБЯЗАТЕЛЬНО* должны
    быть "загружены".
    Для упрощения этого действия в директории с конфигами NginX'а
    теперь есть директория modules.d.
    Данное нововведение полезно, например тем, что нет необходимости в
    ручном перечислении модулей.
    Достаточно добавить директиву 'include' с указанием нужного
    конфигурационного файла (вида "ИМЯ_ПАКЕТА.conf") самой первой
    строчкой в файл nginx.conf.

    Например, при добавлении в nginx.conf первой строкой директивы:

        include modules.d/*.conf;

    вы получите автоматическое "подхватывание" (при reload'е)
    свежеустановленных модулей.

    Так же, если вы предпочитаете явное перечисление необходимых
    модулей, вы можете использовать ссылку "modules" (которая указывает
    на системную директорию с модулями).
    Данная идея реализована по аналогии с пакетами NginX для
    CentOS/Ubuntu/прочих_подобных.
    Таким образом, вы можете указывать необходимые модули добавляя
    в самое начало nginx.conf директивы вида:

        load modules/[подставить_имя_модуля].so;

2) Печальная новость состоит в том, что есть несколько модулей, которые
    "сломались".
    Произошло это из-за их заброшенности (в течение 4-10 лет), а так же
    плохой реализации (необходимость патчинга исходников NginX'а и
    добавление в NginX функций, объявленных внутри модулей).

    Вообще, последнего (патчинга исходников NginX'а) не должно было
    быть изначально с их стороны.
    И если исправить "статичность" модуля и сделать его динамичнеским
    довольно легко, то их правка для отпадания необходимоси патчинга
    NginX - задача уже менее тривиальная.
    А учитывая их заброшенность - апстрим этим заниматься так же
    не будет (как, впрочем, и исправлять баги).

    В связи с этим, я временно их замаскировал (на самом деле их всего
    несколько, и шансы, что вы их используете довольно малы).
    В будущем - я попробую починить данные модули, но на данный момент
    такой возможности у меня нет.

    Одним из таких модулей, кстати, является www-nginx/supervisord.

В любом случае, если вы испытываете какие-либо затруднения - вы можете
написать issue на GitHub или письмо мне на e-mail.
